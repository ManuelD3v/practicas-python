class Libro:

    def __init__(self, titulo : str, autor : str, isbn : str, ejemplares_disponibles : int):
        self.titulo = titulo
        self.autor = autor
        self.isbn = isbn
        self.ejemplares_disponibles = ejemplares_disponibles

    def __str__(self):
        libro = ""
        libro += "titulo: " + self.titulo + '\n'
        libro += "autor: " + self.autor + '\n'
        libro += "ISBN: " + self.isbn + '\n'
        libro += "ejemplares disponibles: " + str (self.ejemplares_disponibles)

        return libro
    
class Biblioteca:

    def __init__(self):
        self.estanteria = {}

    def agregar_libro(self,libro : Libro):

        self.estanteria[libro.isbn] = libro

    def buscar_por_titulo(self,titulo : str):
        paquete = []

        for x in self.estanteria.values():
            if x.titulo == titulo:
                paquete.append(x)
        
        return paquete
    
    def buscar_por_autor(self,autor : str):
        paquete = []

        for x in self.estanteria.values():
            if x.autor == autor:
                paquete.append(x)
        
        return paquete
    
    def prestar_libro(self, isbn : str):

        for x in self.estanteria:

            if x == isbn:
                if self.estanteria[x].ejemplares_disponibles > 0:
                    self.estanteria[x].ejemplares_disponibles -= 1
                    return True
                else:
                    return False

    def devolver_libro(self, isbn : str):

        for x in self.estanteria:
            if x == isbn:
                self.estanteria[x].ejemplares_disponibles += 1
                return True
        
        return False
    
    def listar_libros(self):
        indice = 1
        for x in self.estanteria.values():
            print ("___________________________")
            print (f"Libro numero {indice}")
            print ("___________________________")
            print (x)
            indice += 1

biblioteca = Biblioteca()


def menu():
    print(" Menu ")
    print("1. Agregar libro")
    print("2. Buscar por titulo")
    print("3. Buscar por autor")
    print("4. Prestar libro")
    print("5. Devolver libro")
    print("6. Lista de libros")
    print("7. Salir")

def pedir_libro():
    titulo = input("Titulo: ")
    autor = input("Autor: ")
    isbn = input("Isbn: ")
    ejemplares = int(input("Numero de ejemplares disponibles: "))

    libro : Libro

    libro = Libro(titulo, autor, isbn, ejemplares)

    biblioteca.agregar_libro(libro)

def pedir_titulo():
    titulo = input("Titulo: ")

    libros = biblioteca.buscar_por_titulo(titulo)
    if libros.__len__ == 0:
        print("No hay libros con ese titulo")
    else:
        for x in libros:
            print(x)
    
def pedir_autor():
    autor = input("Autor: ")

    libros = biblioteca.buscar_por_autor(autor)
    if libros.__len__ == 0:
        print("No hay libros con ese autor")
    else:
        for x in libros:
            print(x)

def prestar_libro():
    isbn = input("Dame el isbn del libro: ")

    if biblioteca.prestar_libro(isbn):
        print("Prestamo exitoso")
    else:
        print("Prestamo fallido")

def devolver_libro():
    isbn = input("Dame el isbn del libro: ")

    if biblioteca.devolver_libro(isbn):
        print("Devolucion exitosa")
    
    else:
        print("Devolucion fallida")

opcion : int
opcion = None
while (opcion != 7):
    
    menu()
    opcion = int(input("Seleccion: "))

    match opcion:
        case 1 : pedir_libro() 

        case 2 : pedir_titulo()

        case 3 : pedir_autor()

        case 4 : prestar_libro()

        case 5 : devolver_libro()

        case 6: biblioteca.listar_libros()
